<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>PFDS.3.RedBlackTree</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle"><img width=50px src=https://images-na.ssl-images-amazon.com/images/I/41XlPaC%2BZqL._SX326_BO1,204,203,200_.jpg /> PFDS.3.RedBlackTree</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Program.Program.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">Program</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.Arith.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">Arith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">String</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">List</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.funind.Recdef.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">Recdef</span></a>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="PFDS.common.Util.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">PFDS.common.Util</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="PFDS.common.DecidableOrder.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">PFDS.common.DecidableOrder</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="PFDS.common.Result.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">PFDS.common.Result</span></a>.<br/>

<br/>
<span class="id" title="keyword">Declare Module</span> <a name="Seed"><span class="id" title="module">Seed</span></a> : <a class="idref" href="PFDS.common.DecidableOrder.html#Seed"><span class="id" title="module">DecidableOrder.Seed</span></a>.<br/>
<span class="id" title="keyword">Module</span> <a name="Elem"><span class="id" title="module">Elem</span></a> := <a class="idref" href="PFDS.common.DecidableOrder.html#Make"><span class="id" title="module">DecidableOrder.Make</span></a>(<a class="idref" href="PFDS.3.RedBlackTree.html#Seed"><span class="id" title="module">Seed</span></a>).<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Elem.Op</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab33"></a><h2 class="section">赤黒木(Red Black Tree)</h2>


<div class="paragraph"> </div>

    <img width="100%" src="https://raw.githubusercontent.com/yoshihiro503/pfds_coq/master/imgs/redblacktree_sample.jpg" />
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="color"><span class="id" title="inductive">color</span></a> := <a name="489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> | <a name="b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="tree"><span class="id" title="inductive">tree</span></a> : <span class="id" title="keyword">Set</span> :=<br/>
| <a name="E"><span class="id" title="constructor">E</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a><br/>
| <a name="T"><span class="id" title="constructor">T</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#color"><span class="id" title="inductive">color</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a name="BlackE"><span class="id" title="constructor">BlackE</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><br/>
| <a name="BlackT"><span class="id" title="constructor">BlackT</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>).<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab34"></a><h3 class="section">tree型の値が赤黒木となっているかという述語</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> ここでいうLengthは経路に含まれる黒ノードの数(赤黒木の全ての経路で黒ノードの数は同じ)

</li>
<li> treeのElem.Tの順序については何も言っていない

</li>
</ul>
 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a name="BE"><span class="id" title="constructor">BE</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> 0 <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><br/>
| <a name="BRed"><span class="id" title="constructor">BRed</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>)<br/>
| <a name="BBlack"><span class="id" title="constructor">BBlack</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> (1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a>) (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>)<br/>
.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="WellColored"><span class="id" title="inductive">WellColored</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a name="CE"><span class="id" title="constructor">CE</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><br/>
| <a name="CRed"><span class="id" title="constructor">CRed</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>)<br/>
| <a name="CBlack"><span class="id" title="constructor">CBlack</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>)<br/>
.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab35"></a><h2 class="section">演習 3.8</h2>


<div class="paragraph"> </div>

    次のような方針でいけそう:
<pre>
  // 赤黒木のサイズの最小値は黒しか持たない木 (完全木)
  size (t) &gt;= 2^(黒depth(t)) - 1
  // 両辺 +1 して logをとると
  log (size(t) + 1) &gt;= log (2^(黒depth(t)) - 1 + 1)
    (右辺) = 黒depth(t)
  // 両辺 floor をとると
  |_ log(size(t) + 1 _| &gt;= |_ 黒depth(t) _| = 黒depth(t)
  // 上記の depth(t) &lt;= 2 * 黒depth(t) より
    (右辺) &gt;= depth(t) / 2
  // 両辺2倍して 2|_ log(size(t) + 1 _| &gt;= depth(t)
</pre>
 
<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a name="lab36"></a><h2 class="section">insert</h2>

 
<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a name="lab37"></a><h3 class="section"><span class="inlinecode"><span class="id" title="var">insert</span></span>関数の定義</h3>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="balance"><span class="id" title="definition">balance</span></a> <span class="id" title="var">color</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#color"><span class="id" title="variable">color</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> <span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">z</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">a</span> <span class="id" title="var">x</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">z</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span>) <span class="id" title="var">z</span> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">b</span> <span class="id" title="var">y</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">c</span> <span class="id" title="var">z</span> <span class="id" title="var">d</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">c</span> <span class="id" title="var">z</span> <span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#color"><span class="id" title="variable">color</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PFDS.3.RedBlackTree.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <span class="id" title="var">color</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.common.DecidableOrder.html#5313db93c887998f343ac11879ac6bc2"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">then</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="var">color</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">a</span>) <span class="id" title="var">y</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">y</span> <a class="idref" href="PFDS.common.DecidableOrder.html#5313db93c887998f343ac11879ac6bc2"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="var">color</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="PFDS.3.RedBlackTree.html#s"><span class="id" title="variable">s</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="insert"><span class="id" title="definition">insert</span></a> (<span class="id" title="var">x</span>: <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a>) (<span class="id" title="var">s</span>: <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a>) : <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Functional Scheme</span> <span class="id" title="var">ins_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">ins</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>

<br/>
</div>

<div class="doc">
    <span class="inlinecode"><span class="id" title="var">balance</span></span>関数で場合分けを簡単にするための補題。
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="balance_aux"><span class="id" title="lemma">balance_aux</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#color"><span class="id" title="inductive">color</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span> <span class="id" title="var">H3</span> <span class="id" title="var">H4</span> <span class="id" title="var">Hother</span> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">Hother</span> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">col</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>|].<br/>
&nbsp;(<span class="id" title="tactic">destruct</span> <span class="id" title="var">t1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c1</span> <span class="id" title="var">t11</span> <span class="id" title="var">x1</span> <span class="id" title="var">t12</span>]; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">destruct</span> <span class="id" title="var">t11</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c11</span> <span class="id" title="var">t11_1</span> <span class="id" title="var">x11</span> <span class="id" title="var">t11_2</span>]; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c11</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">destruct</span> <span class="id" title="var">t12</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c12</span> <span class="id" title="var">t12_1</span> <span class="id" title="var">x12</span> <span class="id" title="var">t12_2</span>]; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c12</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c2</span> <span class="id" title="var">t21</span> <span class="id" title="var">x2</span> <span class="id" title="var">t22</span>]; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">destruct</span> <span class="id" title="var">t21</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c21</span> <span class="id" title="var">t21_1</span> <span class="id" title="var">x21</span> <span class="id" title="var">t21_2</span>]; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c21</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">destruct</span> <span class="id" title="var">t22</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">c22</span> <span class="id" title="var">t22_1</span> <span class="id" title="var">x22</span> <span class="id" title="var">t22_2</span>]; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c22</span>])<br/>
&nbsp;&nbsp;]); <span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a>; <span class="id" title="tactic">try</span> (<span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab38"></a><h3 class="section">insertに関する証明</h3>

 
<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a name="lab39"></a><h4 class="section">insertが不変条件2の「すべての経路で黒の数が同一」を保つことを証明</h4>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="balance_Balanced"><span class="id" title="lemma">balance_Balanced</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">color</span> <span class="id" title="var">elem</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#color"><span class="id" title="variable">color</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#elem"><span class="id" title="variable">elem</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#color"><span class="id" title="variable">color</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#elem"><span class="id" title="variable">elem</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>)<br/>
.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">col</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_aux"><span class="id" title="lemma">balance_aux</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">col</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t1</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">e</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t2</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">t</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <span class="id" title="var">n</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <span class="id" title="var">n</span> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H11</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H11</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ins_Balanced"><span class="id" title="lemma">ins_Balanced</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>. <span class="id" title="var">revert</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins_ind"><span class="id" title="lemma">ins_ind</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> <span class="id" title="var">HBt</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">HBt</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">Hlt</span> <span class="id" title="var">_</span> <span class="id" title="var">IHa</span> <span class="id" title="var">n</span> <span class="id" title="var">HBt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_Balanced"><span class="id" title="lemma">balance_Balanced</span></a>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">HBt</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hlt</span> <span class="id" title="var">_</span> <span class="id" title="var">IHb</span> <span class="id" title="var">n</span> <span class="id" title="var">HBt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_Balanced"><span class="id" title="lemma">balance_Balanced</span></a>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">HBt</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">eq</span> <span class="id" title="var">Hnotlt1</span> <span class="id" title="var">_</span> <span class="id" title="var">Hnotlt2</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> <span class="id" title="var">HBt</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="insert_Balanced"><span class="id" title="lemma">insert_Balanced</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#m"><span class="id" title="variable">m</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#insert"><span class="id" title="definition">insert</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="var">HBal</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#insert"><span class="id" title="definition">insert</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins_Balanced"><span class="id" title="lemma">ins_Balanced</span></a> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">HBal</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>|<span class="id" title="var">n</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">∃</span> 0.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">∃</span> (1 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <span class="id" title="var">n</span>). <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">∃</span> (1 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <span class="id" title="var">n</span>). <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab40"></a><h4 class="section">insertが不変条件1の「赤が2連続で現れない」を保つことを証明</h4>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="balance_color_changed"><span class="id" title="lemma">balance_color_changed</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_aux"><span class="id" title="lemma">balance_aux</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">col</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t1'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">e'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t2'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">t</span> ⇒ <span class="id" title="var">col</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <span class="id" title="var">t1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <span class="id" title="var">t2</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> <span class="id" title="var">Hcol</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> <span class="id" title="var">Hcol</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> <span class="id" title="var">Hcol</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> <span class="id" title="var">Hcol</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> 1. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">col</span> <span class="id" title="var">t1'</span> <span class="id" title="var">e'</span> <span class="id" title="var">t2'</span> <span class="id" title="var">Hcol</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">inversion</span> 1. <span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ins_color_changed"><span class="id" title="lemma">ins_color_changed</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#IsRootBlack"><span class="id" title="inductive">IsRootBlack</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">HC</span> <span class="id" title="var">HBt</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">HBt</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">inversion</span> 1. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">x</span> <a class="idref" href="PFDS.common.DecidableOrder.html#5313db93c887998f343ac11879ac6bc2"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">y</span>); [|<span class="id" title="tactic">destruct</span> (<span class="id" title="var">y</span> <a class="idref" href="PFDS.common.DecidableOrder.html#5313db93c887998f343ac11879ac6bc2"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">x</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_color_changed"><span class="id" title="lemma">balance_color_changed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_color_changed"><span class="id" title="lemma">balance_color_changed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> 1.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="balance_Colored_a"><span class="id" title="lemma">balance_Colored_a</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">col_a</span> <span class="id" title="var">a1</span> <span class="id" title="var">x</span> <span class="id" title="var">a2</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col_a"><span class="id" title="variable">col_a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a2"><span class="id" title="variable">a2</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col_a"><span class="id" title="variable">col_a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a2"><span class="id" title="variable">a2</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col_a"><span class="id" title="variable">col_a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a2"><span class="id" title="variable">a2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">col_a</span> <span class="id" title="var">a1</span> <span class="id" title="var">x</span> <span class="id" title="var">a2</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">Hbal</span> <span class="id" title="var">Ca1</span> <span class="id" title="var">Ca2</span> <span class="id" title="var">Cb</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">col_a</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>|]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hbal</span>|<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>|]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hbal</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; [|<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>]; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hbal</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="balance_Colored_b"><span class="id" title="lemma">balance_Colored_b</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">col_b</span> <span class="id" title="var">b1</span> <span class="id" title="var">x</span> <span class="id" title="var">b2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col_b"><span class="id" title="variable">col_b</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b1"><span class="id" title="variable">b1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b2"><span class="id" title="variable">b2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col_b"><span class="id" title="variable">col_b</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b1"><span class="id" title="variable">b1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b2"><span class="id" title="variable">b2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b1"><span class="id" title="variable">b1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b2"><span class="id" title="variable">b2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col_b"><span class="id" title="variable">col_b</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b1"><span class="id" title="variable">b1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b2"><span class="id" title="variable">b2</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">col_b</span> <span class="id" title="var">b1</span> <span class="id" title="var">x</span> <span class="id" title="var">b2</span> <span class="id" title="var">Hbal</span> <span class="id" title="var">Cb1</span> <span class="id" title="var">Cb2</span> <span class="id" title="var">Ca</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">col_b</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b1</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>|]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hbal</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|[|] [|[|] <span class="id" title="var">a11</span> <span class="id" title="var">e1</span> <span class="id" title="var">a12</span>] <span class="id" title="var">e</span> [|[|] <span class="id" title="var">a21</span> <span class="id" title="var">e2</span> <span class="id" title="var">a22</span>]]; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hbal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">b2</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>|]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hbal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|[|] [|[|] <span class="id" title="var">a11</span> <span class="id" title="var">e1</span> <span class="id" title="var">a12</span>] <span class="id" title="var">e</span> [|[|] <span class="id" title="var">a21</span> <span class="id" title="var">e2</span> <span class="id" title="var">a22</span>]], <span class="id" title="var">b1</span> <span class="id" title="keyword">as</span> [|[|] <span class="id" title="var">b11</span> <span class="id" title="var">x1</span> <span class="id" title="var">b12</span>]; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hbal</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ins_Colored"><span class="id" title="lemma">ins_Colored</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">e</span> <span class="id" title="var">col</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins_ind"><span class="id" title="lemma">ins_ind</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HC</span>. <span class="id" title="tactic">∃</span> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a>, <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a>, <span class="id" title="var">x</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a>. <span class="id" title="var">now</span> <span class="id" title="tactic">split</span>; [|<span class="id" title="tactic">split</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">Hlt</span> <span class="id" title="var">_</span> <span class="id" title="var">IHa</span> <span class="id" title="var">HC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">a</span>); [<span class="id" title="tactic">intros</span> <span class="id" title="var">HCa</span>| <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">b</span>); [<span class="id" title="tactic">intros</span> <span class="id" title="var">HCb</span>| <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHa</span> <span class="id" title="var">HCa</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">t1</span> [<span class="id" title="var">t2</span> [<span class="id" title="var">e</span> [<span class="id" title="var">col_a</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">HCt1</span> <span class="id" title="var">HCt2</span>]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_aux"><span class="id" title="lemma">balance_aux</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">col'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">a'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">y'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">b'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">t</span> ⇒ <span class="id" title="var">col'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">col</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="var">y'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="var">col</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">a</span>) <span class="id" title="var">y</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">e</span> <span class="id" title="var">col0</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col0"><span class="id" title="variable">col0</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hz</span> <span class="id" title="var">Hd</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">z'</span> <span class="id" title="var">d'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">x'</span> <span class="id" title="var">b'</span>), (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">c'</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span>), <span class="id" title="var">y'</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>|]. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HCt1</span>|<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hz</span> <span class="id" title="var">Hd</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">z'</span> <span class="id" title="var">d'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a'</span> <span class="id" title="var">x'</span> <span class="id" title="var">b'</span>), (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">c'</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span>), <span class="id" title="var">y'</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>|]. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HCt2</span>. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hz</span> <span class="id" title="var">Hd</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">a'</span> <span class="id" title="var">x'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hd</span> <span class="id" title="keyword">in</span> <span class="id" title="var">HCb</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HCb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hz</span> <span class="id" title="var">Hd</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">a'</span> <span class="id" title="var">x'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hd</span> <span class="id" title="keyword">in</span> <span class="id" title="var">HCb</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HCb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">col'</span> <span class="id" title="var">a'</span> <span class="id" title="var">y'</span> <span class="id" title="var">b'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hy'</span> <span class="id" title="var">Hb'</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">a</span>), <span class="id" title="var">b</span>, <span class="id" title="var">y</span>, <span class="id" title="var">col</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>| ]. <span class="id" title="tactic">split</span>;[ |<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">col_a</span>; [| <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins_color_changed"><span class="id" title="lemma">ins_color_changed</span></a> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">H3</span> <span class="id" title="var">H5</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Bt1</span> <span class="id" title="var">Bt2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_Colored_a"><span class="id" title="lemma">balance_Colored_a</span></a> <span class="id" title="var">col_a</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">IHb</span> <span class="id" title="var">HC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">a</span>); [<span class="id" title="tactic">intros</span> <span class="id" title="var">HCa</span>| <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">b</span>); [<span class="id" title="tactic">intros</span> <span class="id" title="var">HCb</span>| <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHb</span> <span class="id" title="var">HCb</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">t1</span> [<span class="id" title="var">t2</span> [<span class="id" title="var">e</span> [<span class="id" title="var">col_b</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">HCt1</span> <span class="id" title="var">HCt2</span>]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_aux"><span class="id" title="lemma">balance_aux</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">col'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">a'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">y'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">b'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">t</span> ⇒ <span class="id" title="var">col'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">col</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="var">y'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">e</span> <span class="id" title="var">col0</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col0"><span class="id" title="variable">col0</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hz</span> <span class="id" title="var">Hd</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">z'</span> <span class="id" title="var">d'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hins</span> <span class="id" title="keyword">in</span> <span class="id" title="var">HCa</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HCa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Hins</span> [<span class="id" title="var">Hz</span> <span class="id" title="var">Hd</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">z'</span> <span class="id" title="var">d'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hins</span> <span class="id" title="keyword">in</span> <span class="id" title="var">HCa</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HCa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hins</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">a'</span> <span class="id" title="var">x'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b'</span>), (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">c'</span> <span class="id" title="var">z'</span> <span class="id" title="var">d'</span>), <span class="id" title="var">y'</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>|]. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HCt1</span>. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c'</span> <span class="id" title="var">d'</span> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> <span class="id" title="var">z'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hins</span>]]] <span class="id" title="var">Hbalance</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">a'</span> <span class="id" title="var">x'</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b'</span>), (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">c'</span> <span class="id" title="var">z'</span> <span class="id" title="var">d'</span>), <span class="id" title="var">y'</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>|]. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hins</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HCt2</span>. <span class="id" title="tactic">split</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">col'</span> <span class="id" title="var">a'</span> <span class="id" title="var">y'</span> <span class="id" title="var">b'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy'</span> <span class="id" title="var">Hins</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span>  <span class="id" title="var">a</span>, (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <span class="id" title="var">x</span> <span class="id" title="var">b</span>), <span class="id" title="var">y</span>, <span class="id" title="var">col</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span>| ]. <span class="id" title="tactic">split</span>;[<span class="id" title="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">col_b</span>; [| <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins_color_changed"><span class="id" title="lemma">ins_color_changed</span></a> <span class="id" title="var">b</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">H4</span> <span class="id" title="var">H6</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Bt1</span> <span class="id" title="var">Bt2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_Colored_b"><span class="id" title="lemma">balance_Colored_b</span></a> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">col_b</span> <span class="id" title="var">t1</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">Hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HC</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">a</span>, <span class="id" title="var">b</span>, <span class="id" title="var">y</span>, <span class="id" title="var">col</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">a</span>); [<span class="id" title="tactic">intros</span> <span class="id" title="var">HCa</span>| <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">b</span>); [<span class="id" title="tactic">intros</span> <span class="id" title="var">HCb</span>| <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HC</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="insert_Colored"><span class="id" title="lemma">insert_Colored</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#insert"><span class="id" title="definition">insert</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="var">HCt</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#insert"><span class="id" title="definition">insert</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins_Colored"><span class="id" title="lemma">ins_Colored</span></a> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">HCt</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">t1</span> [<span class="id" title="var">t2</span> [<span class="id" title="var">e</span> [<span class="id" title="var">col</span> [<span class="id" title="var">Heq</span> [<span class="id" title="var">HCt1</span> <span class="id" title="var">HCt2</span>]]]]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab41"></a><h4 class="section"><span class="inlinecode"><span class="id" title="var">insert</span></span>で木の順序が崩れていないことを証明</h4>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="TreeForall"><span class="id" title="inductive">TreeForall</span></a> (<span class="id" title="var">P</span> : <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) : <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a name="TreeForallE"><span class="id" title="constructor">TreeForallE</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <span class="id" title="var">P</span> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><br/>
| <a name="TreeForallT"><span class="id" title="constructor">TreeForallT</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> <span class="id" title="var">t2</span>, <span class="id" title="var">P</span> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <span class="id" title="var">P</span> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <span class="id" title="var">P</span> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <span class="id" title="var">P</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>).<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span>: <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Q"><span class="id" title="variable">Q</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">t</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Q"><span class="id" title="variable">Q</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">Impl</span> <span class="id" title="var">t</span> <span class="id" title="var">Pt</span>.<br/>
&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Pt</span>.<br/>
&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;- <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="balance_Forall"><span class="id" title="lemma">balance_Forall</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">P</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">Pa</span> <span class="id" title="var">Py</span> <span class="id" title="var">Pb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_aux"><span class="id" title="lemma">balance_aux</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">col'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t1</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">e</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t2</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">t</span> ⇒ <span class="id" title="var">col'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">col</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a><span class="id" title="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a><span class="id" title="var">t2</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <span class="id" title="var">P</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>))).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y'</span> <span class="id" title="var">z</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Pa</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y'</span> <span class="id" title="var">z</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Pa</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y'</span> <span class="id" title="var">z</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Pb</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b'</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span> <span class="id" title="var">y'</span> <span class="id" title="var">z</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Pb</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">col'</span> <span class="id" title="var">a'</span> <span class="id" title="var">y'</span> <span class="id" title="var">b'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ins_Forall"><span class="id" title="lemma">ins_Forall</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins_ind"><span class="id" title="lemma">ins_ind</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Px</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">IHa</span> <span class="id" title="var">Pt</span> <span class="id" title="var">Px</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Pt</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_Forall"><span class="id" title="lemma">balance_Forall</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">IHb</span> <span class="id" title="var">Pt</span> <span class="id" title="var">Px</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Pt</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_Forall"><span class="id" title="lemma">balance_Forall</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">Heq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Pt</span> <span class="id" title="var">Px</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
     二分木の要素が対象順(symmetric order)で格納されているということを示す<span class="inlinecode"><span class="id" title="keyword">Prop</span></span>。
     「対象順とは任意の与えられたノードの要素が、その左側の部分木の中のどの要素よりも大きく、
     右側の部分木のどの要素よりも小さい、という意味である」
 
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <a name="Ordered"><span class="id" title="inductive">Ordered</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
| <a name="OrderedE"><span class="id" title="constructor">OrderedE</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><br/>
| <a name="OrderedT"><span class="id" title="constructor">OrderedT</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">col</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> <span class="id" title="var">t2</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x1</span> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="PFDS.common.TotalOrder.html#db24593efd516477ddcf1c3df9d7254e"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a>(<span class="id" title="keyword">fun</span> <span class="id" title="var">x2</span> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.common.TotalOrder.html#db24593efd516477ddcf1c3df9d7254e"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x2"><span class="id" title="variable">x2</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t2"><span class="id" title="variable">t2</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="balance_Ordered"><span class="id" title="lemma">balance_Ordered</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span>,<br/>
&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.common.TotalOrder.html#db24593efd516477ddcf1c3df9d7254e"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall"><span class="id" title="inductive">TreeForall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.common.TotalOrder.html#db24593efd516477ddcf1c3df9d7254e"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance"><span class="id" title="definition">balance</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#col"><span class="id" title="variable">col</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">Orda</span> <span class="id" title="var">Ordb</span> <span class="id" title="var">Lt_ay</span> <span class="id" title="var">Lt_yb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#balance_aux"><span class="id" title="lemma">balance_aux</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">col'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">a'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">y'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">b'</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">t</span> ⇒ <span class="id" title="var">col'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">col</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a><span class="id" title="var">a'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a><span class="id" title="var">y'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a><span class="id" title="var">b'</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>)).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a11</span> <span class="id" title="var">a12</span> <span class="id" title="var">a2</span> <span class="id" title="var">b'</span> <span class="id" title="var">e2</span> <span class="id" title="var">e1</span> <span class="id" title="var">y'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Orda</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a1</span> <span class="id" title="var">x1'</span> <span class="id" title="var">a2'</span> <span class="id" title="var">Orda1</span> <span class="id" title="var">Orda2</span> <span class="id" title="var">Lt_a1</span> <span class="id" title="var">Lt_a2</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Orda</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Orda1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a''</span> <span class="id" title="var">x'</span> <span class="id" title="var">b''</span> <span class="id" title="var">Orda'</span> <span class="id" title="var">Ordb'</span> <span class="id" title="var">Lt_a'</span> <span class="id" title="var">Lt_b'</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Orda1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_ay</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a1</span> <span class="id" title="var">x1'</span> <span class="id" title="var">a2'</span> <span class="id" title="var">Lt_x1</span> <span class="id" title="var">Lt_a1'</span> <span class="id" title="var">Lt_a2'</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_ay</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_a1</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | <span class="id" title="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">Lt_yb</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#lt_trans"><span class="id" title="axiom">Elem.Ord.lt_trans</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a1</span> <span class="id" title="var">a21</span> <span class="id" title="var">a22</span> <span class="id" title="var">b'</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> <span class="id" title="var">y'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Orda</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a1'</span> <span class="id" title="var">x1'</span> <span class="id" title="var">a2</span> <span class="id" title="var">Orda1</span> <span class="id" title="var">Orda2</span> <span class="id" title="var">Lt_a1</span> <span class="id" title="var">Lt_a2</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Orda</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Orda2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a''</span> <span class="id" title="var">x'</span> <span class="id" title="var">b''</span> <span class="id" title="var">Orda'</span> <span class="id" title="var">Ordb'</span> <span class="id" title="var">Lt_a'</span> <span class="id" title="var">Lt_b'</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Orda2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_ay</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a1'</span> <span class="id" title="var">x1'</span> <span class="id" title="var">a2'</span> <span class="id" title="var">Lt_x1</span> <span class="id" title="var">Lt_a1'</span> <span class="id" title="var">Lt_a2'</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_ay</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_a2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a21'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">a22'</span> <span class="id" title="var">Lt_e12</span> <span class="id" title="var">Lt_a21</span> <span class="id" title="var">Lt_a22</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_a2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_a2'</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">a21'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">a22'</span> <span class="id" title="var">Lt_e1y</span> <span class="id" title="var">Lt_a21'</span> <span class="id" title="var">Lt_a22'</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_a2'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span>| |<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">Lt_a1</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">a1_x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hlt</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#lt_trans"><span class="id" title="axiom">Elem.Ord.lt_trans</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hlt</span> <span class="id" title="var">Lt_e12</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | <span class="id" title="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">Lt_yb</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">b_x</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#lt_trans"><span class="id" title="axiom">Elem.Ord.lt_trans</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b11</span> <span class="id" title="var">b12</span> <span class="id" title="var">b2</span> <span class="id" title="var">y'</span> <span class="id" title="var">e2</span> <span class="id" title="var">e1</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ordb</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b1</span> <span class="id" title="var">e1'</span> <span class="id" title="var">b2'</span> <span class="id" title="var">Ordb1</span> <span class="id" title="var">Ordb2</span> <span class="id" title="var">Lt_b1e1</span> <span class="id" title="var">Lt_e1b2</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ordb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ordb1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b11'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">b12'</span> <span class="id" title="var">Ordb11</span> <span class="id" title="var">Ordb12</span> <span class="id" title="var">Lt_b11</span> <span class="id" title="var">Lt_b12</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ordb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_yb</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b11'</span> <span class="id" title="var">e1'</span> <span class="id" title="var">b2'</span> <span class="id" title="var">Lt_xe1</span> <span class="id" title="var">Lt_yb1</span> <span class="id" title="var">Lt_yb2</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_yb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_b1e1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b11'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">b12'</span> <span class="id" title="var">Lt_e2e1</span> <span class="id" title="var">Lt_b11e1</span> <span class="id" title="var">Lt_b12e1</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_b1e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_yb1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b11'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">b12'</span> <span class="id" title="var">Lt_ye2</span> <span class="id" title="var">Lt_yb11</span> <span class="id" title="var">Lt_yb12</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_yb1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span>| |<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">Lt_ay</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">a_x</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlt</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#lt_trans"><span class="id" title="axiom">Elem.Ord.lt_trans</span></a> <span class="id" title="var">_</span> <span class="id" title="var">y</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span> | <span class="id" title="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">Lt_e1b2</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#lt_trans"><span class="id" title="axiom">Elem.Ord.lt_trans</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">b1</span> <span class="id" title="var">b21</span> <span class="id" title="var">b22</span> <span class="id" title="var">y'</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ordb</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b1'</span> <span class="id" title="var">e1'</span> <span class="id" title="var">b2'</span> <span class="id" title="var">Ordb1</span> <span class="id" title="var">Ordb2</span> <span class="id" title="var">Lt_b1e1</span> <span class="id" title="var">Lt_e1b2</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ordb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ordb2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b21'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">b22'</span> <span class="id" title="var">Ordb21</span> <span class="id" title="var">Ordb22</span> <span class="id" title="var">Lt_b21</span> <span class="id" title="var">Lt_b22</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ordb2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_yb</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b11'</span> <span class="id" title="var">e1'</span> <span class="id" title="var">b2'</span> <span class="id" title="var">Lt_ye1</span> <span class="id" title="var">Lt_yb1</span> <span class="id" title="var">Lt_yb2</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_yb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_e1b2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b21'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">b22'</span> <span class="id" title="var">Lt_e2e1</span> <span class="id" title="var">Lt_e1b21</span> <span class="id" title="var">Lt_e1b22</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_e1b2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Lt_yb2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">col</span> <span class="id" title="var">b21'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">b22'</span> <span class="id" title="var">Lt_ye2</span> <span class="id" title="var">Lt_yb21</span> <span class="id" title="var">Lt_yb22</span>]. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Lt_yb2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">assumption</span>| |<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#TreeForall_impl"><span class="id" title="lemma">TreeForall_impl</span></a>; [|<span class="id" title="tactic">exact</span> <span class="id" title="var">Lt_ay</span>]. <span class="id" title="tactic">intros</span> <span class="id" title="var">a_x</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hlt</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#lt_trans"><span class="id" title="axiom">Elem.Ord.lt_trans</span></a> <span class="id" title="var">_</span> <span class="id" title="var">y</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">col'</span> <span class="id" title="var">a'</span> <span class="id" title="var">y'</span> <span class="id" title="var">b'</span> [<span class="id" title="var">Hcol</span> [<span class="id" title="var">Ha</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hb</span>]]]. <span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ins_Ordered"><span class="id" title="lemma">ins_Ordered</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins"><span class="id" title="definition">ins</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins_ind"><span class="id" title="lemma">ins_ind</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Ordt</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">Hlt</span> <span class="id" title="var">_</span> <span class="id" title="var">IHa</span> <span class="id" title="var">Ordt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ordt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_Ordered"><span class="id" title="lemma">balance_Ordered</span></a>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>| <span class="id" title="tactic">assumption</span>| |<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins_Forall"><span class="id" title="lemma">ins_Forall</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hgt</span> <span class="id" title="var">_</span> <span class="id" title="var">IHa</span> <span class="id" title="var">Ordt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ordt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#balance_Ordered"><span class="id" title="lemma">balance_Ordered</span></a>; [<span class="id" title="tactic">assumption</span> | <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span> | <span class="id" title="tactic">assumption</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="PFDS.3.RedBlackTree.html#ins_Forall"><span class="id" title="lemma">ins_Forall</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">col</span> <span class="id" title="var">a</span> <span class="id" title="var">y</span> <span class="id" title="var">b</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Hgt</span> <span class="id" title="var">_</span> <span class="id" title="var">Hlt</span> <span class="id" title="var">_</span> <span class="id" title="var">Ordt</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="insert_Ordered"><span class="id" title="lemma">insert_Ordered</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#Ordered"><span class="id" title="inductive">Ordered</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#insert"><span class="id" title="definition">insert</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="var">Ordt</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#insert"><span class="id" title="definition">insert</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#ins_Ordered"><span class="id" title="lemma">ins_Ordered</span></a> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">Ordt</span>); <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab42"></a><h2 class="section">演習 3.9</h2>


<div class="paragraph"> </div>

 重複のないソート済みリストから赤黒木へ変換する、型 <span class="inlinecode"><span class="id" title="var">list</span></span> <span class="inlinecode"><span class="id" title="var">Elem.T</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">tree</span></span> の関数 <span class="inlinecode"><span class="id" title="var">fromOrdList</span></span> を書いて見よう。
 その関数は O(n) 時間で実行できるはずだ。
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.omega.Omega.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">Omega</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="PFDS.common.Modulo.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">PFDS.common.Modulo</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="dummyE"><span class="id" title="variable">dummyE</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab43"></a><h3 class="section">補助関数を定義</h3>


<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">fromOrdListAux</span></span> <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode"><span class="id" title="var">xs</span></span> <span class="inlinecode"><span class="id" title="var">depth</span></span> はリスト<span class="inlinecode"><span class="id" title="var">xs</span></span>の先頭<span class="inlinecode"><span class="id" title="var">k</span></span>個分を赤黒木に変換した木と残りのリストの組みを返す。
 このとき<span class="inlinecode"><span class="id" title="var">depth</span></span>は作るべき木の黒長さとする。また、<span class="inlinecode"><span class="id" title="var">k</span></span>は<span class="inlinecode"><span class="id" title="var">xs</span></span>の長さ以下でなければならない。
 <span class="inlinecode"><span class="id" title="var">dummyE</span></span>は使用されないはず
 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Wf.html#"><span class="id" title="<img width=50px src=https://images-na.ssl-images-amazon.com/images/i/41xlpac%2bzql._sx326_bo1,204,203,200_.jpg />">Init.Wf</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="A"><span class="id" title="definition">A</span></a> : <span class="id" title="keyword">Set</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="keyword">wf</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.Wf_nat.html#well_founded_ltof"><span class="id" title="lemma">well_founded_ltof</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#A"><span class="id" title="definition">A</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">k</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">_</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">_</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> ⇒ <span class="id" title="var">k</span>).<br/>
<span class="id" title="keyword">Definition</span> <a name="fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">xs</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a>) (<span class="id" title="var">d</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : (<a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="keyword">Fix</span> <span class="id" title="keyword">wf</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span>:<a class="idref" href="PFDS.3.RedBlackTree.html#A"><span class="id" title="definition">A</span></a> ⇒ (<a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a>)%<span class="id" title="var">type</span>) (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">k</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">xs</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">d</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> <span class="id" title="var">F</span> ⇒ <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="keyword">match</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> <span class="id" title="var">n</span> <span class="id" title="keyword">return</span> <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 ⇒ <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">exact</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#hd"><span class="id" title="definition">List.hd</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#dummyE"><span class="id" title="axiom">dummyE</span></a> <span class="id" title="var">xs</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xs'</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">List.tl</span></a> <span class="id" title="var">xs</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">d</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span>                 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">k_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> (<a class="idref" href="PFDS.common.Modulo.html#quotient_modulo"><span class="id" title="definition">Modulo.quotient_modulo</span></a> 2) <span class="id" title="keyword">as</span> [[<span class="id" title="var">q</span> <span class="id" title="var">r</span>] [<span class="id" title="var">Hqr</span> <span class="id" title="var">Hr</span>]]; [<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">k</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">q</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">×</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <span class="id" title="var">r</span>) <span class="id" title="keyword">in</span> <span class="id" title="var">k_eq</span>; [|<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hqr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">k1</span> := <span class="id" title="var">q</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">k2</span> := <span class="id" title="keyword">if</span> (<span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <span class="id" title="var">q</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1 <span class="id" title="keyword">else</span> <span class="id" title="var">q</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">ys</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <span class="id" title="var">F</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#k1"><span class="id" title="variable">k1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <span class="id" title="var">_</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#hd"><span class="id" title="definition">List.hd</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#dummyE"><span class="id" title="axiom">dummyE</span></a> <span class="id" title="var">ys</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ys'</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">List.tl</span></a> <span class="id" title="var">ys</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">zs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <span class="id" title="var">F</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#k2"><span class="id" title="variable">k2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ys'"><span class="id" title="variable">ys'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <span class="id" title="var">_</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">zs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">k1</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">k2</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span>; <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="fromOrdListAux_equation"><span class="id" title="lemma">fromOrdListAux_equation</span></a> : <span class="id" title="keyword">∀</span>  (<span class="id" title="var">k</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">xs</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a>) (<span class="id" title="var">d</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1 ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#hd"><span class="id" title="definition">List.hd</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#dummyE"><span class="id" title="axiom">dummyE</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xs'</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">List.tl</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span>                 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k'</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">q</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <a class="idref" href="PFDS.common.Modulo.html#quot_mod"><span class="id" title="definition">Modulo.quot_mod</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a> 2 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">k1</span> := <span class="id" title="var">q</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">k2</span> := <span class="id" title="keyword">if</span> (<span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <span class="id" title="var">q</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1 <span class="id" title="keyword">else</span> <span class="id" title="var">q</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">ys</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k1"><span class="id" title="variable">k1</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#hd"><span class="id" title="definition">List.hd</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#dummyE"><span class="id" title="axiom">dummyE</span></a> <span class="id" title="var">ys</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ys'</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">List.tl</span></a> <span class="id" title="var">ys</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">zs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k2"><span class="id" title="variable">k2</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ys'"><span class="id" title="variable">ys'</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <span class="id" title="var">a</span> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">zs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Wf.html#Fix_eq"><span class="id" title="lemma">Fix_eq</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>; [<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>; [<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.common.Modulo.html#quotient_modulo"><span class="id" title="definition">quotient_modulo</span></a>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">q</span> <span class="id" title="var">r</span>] [<span class="id" title="var">Hqr</span> <span class="id" title="var">Hr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="PFDS.common.Modulo.html#quot_mod_complete"><span class="id" title="axiom">Modulo.quot_mod_complete</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) 2 <span class="id" title="var">q</span> <span class="id" title="var">r</span>); [|<span class="id" title="var">now</span> <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>|<span class="id" title="tactic">assumption</span>|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[<span class="id" title="var">x</span> <span class="id" title="var">xs0</span>] <span class="id" title="var">d0</span>] <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; [<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; [<span class="id" title="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.common.Modulo.html#quotient_modulo"><span class="id" title="definition">quotient_modulo</span></a>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">q</span> <span class="id" title="var">r</span>] [<span class="id" title="var">Hqr</span> <span class="id" title="var">Hr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="wf_ind"><span class="id" title="definition">wf_ind</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Wf.html#well_founded_ind"><span class="id" title="lemma">well_founded_ind</span></a> <span class="id" title="keyword">wf</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="fromOrdListAux_ind"><span class="id" title="lemma">fromOrdListAux_ind</span></a>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">P</span> : <a class="idref" href="PFDS.3.RedBlackTree.html#A"><span class="id" title="definition">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="axiom">Elem.T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">xs</span> <span class="id" title="var">x</span> <span class="id" title="var">xs'</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#hd"><span class="id" title="definition">List.hd</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#dummyE"><span class="id" title="axiom">dummyE</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">List.tl</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<span class="id" title="keyword">if</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#489378dc9f613bf0d741bd39907bf3e4"><span class="id" title="constructor">赤</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span>                 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#E"><span class="id" title="constructor">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">k'</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span> <span class="id" title="var">ys</span> <span class="id" title="var">ys'</span> <span class="id" title="var">zs</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.common.Modulo.html#quot_mod"><span class="id" title="definition">Modulo.quot_mod</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k'"><span class="id" title="variable">k'</span></a>)) 2 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#k1"><span class="id" title="variable">k1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#k2"><span class="id" title="variable">k2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <a class="idref" href="PFDS.3.RedBlackTree.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1 <span class="id" title="keyword">else</span> <a class="idref" href="PFDS.3.RedBlackTree.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#hd"><span class="id" title="definition">List.hd</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#dummyE"><span class="id" title="axiom">dummyE</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ys"><span class="id" title="variable">ys</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#ys'"><span class="id" title="variable">ys'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">List.tl</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ys"><span class="id" title="variable">ys</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#k1"><span class="id" title="variable">k1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ys"><span class="id" title="variable">ys</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#k2"><span class="id" title="variable">k2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#ys'"><span class="id" title="variable">ys'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#zs"><span class="id" title="variable">zs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k'"><span class="id" title="variable">k'</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b399eac098ba7dbe0f3424cfa2270651"><span class="id" title="constructor">黒</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#zs"><span class="id" title="variable">zs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">IH0</span> <span class="id" title="var">IH1</span> <span class="id" title="var">IHS</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Check</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#wf_ind"><span class="id" title="definition">wf_ind</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">k</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">xs</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">d</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> ⇒ <span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>)) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<span class="id" title="keyword">∀</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">k</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">xs</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">d</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a>, <span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">H</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#wf_ind"><span class="id" title="definition">wf_ind</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">k</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">xs</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">d</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> ⇒ <span class="id" title="var">P</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span>)) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[<span class="id" title="var">k</span> <span class="id" title="var">xs</span>] <span class="id" title="var">d</span>] <span class="id" title="var">IH</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.Wf_nat.html#ltof"><span class="id" title="definition">ltof</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH0</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>; [<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH1</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux_equation"><span class="id" title="lemma">fromOrdListAux_equation</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<a class="idref" href="PFDS.common.Modulo.html#quot_mod"><span class="id" title="definition">quot_mod</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) 2). <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">Hqr</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <span class="id" title="var">q</span> <span class="id" title="var">xs</span> (<span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1)). <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">ys</span> <span class="id" title="var">Hfola1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> (<span class="id" title="keyword">if</span> (<span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <span class="id" title="var">q</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1 <span class="id" title="keyword">else</span> <span class="id" title="var">q</span>) (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#tl"><span class="id" title="definition">tl</span></a> <span class="id" title="var">ys</span>) (<span class="id" title="var">d</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">zs</span> <span class="id" title="var">Hfola2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PFDS.common.Modulo.html#quot_mod_sound"><span class="id" title="lemma">Modulo.quot_mod_sound</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) 2 <span class="id" title="var">q</span> <span class="id" title="var">r</span>); [<span class="id" title="var">now</span> <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>| <span class="id" title="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hqr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hfola1</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IH</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">q</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">d</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>). <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hfola2</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IH</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span>; <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
   赤黒木となる条件その2: 赤-赤違反がないこと
   こちらの方が証明が楽なため先に証明する。
 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="fromOrdListAux_WellColored"><span class="id" title="lemma">fromOrdListAux_WellColored</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">t</span> <span class="id" title="var">xs'</span>, <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">t</span> <span class="id" title="var">xs'</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> := <a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="keyword">in</span> <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">t</span>); [<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span>  <span class="id" title="var">Heq</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux_ind"><span class="id" title="lemma">fromOrdListAux_ind</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">k</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">xs</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">d</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat0"><span class="id" title="variable">)</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">'(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">t</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">ys</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#pat"><span class="id" title="variable">)</span></a> ⇒ <a class="idref" href="PFDS.3.RedBlackTree.html#WellColored"><span class="id" title="inductive">WellColored</span></a> <span class="id" title="var">t</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">t</span> <span class="id" title="var">xs'</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">xs</span> <span class="id" title="var">x</span> <span class="id" title="var">xs'</span> <span class="id" title="var">d</span> <span class="id" title="var">Hx</span> <span class="id" title="var">Hxs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">d</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0)%<span class="id" title="var">nat</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">t</span> <span class="id" title="var">xs'</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k'</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span> <span class="id" title="var">ys</span> <span class="id" title="var">ys'</span> <span class="id" title="var">zs</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">Hqr</span> <span class="id" title="var">Hk1</span> <span class="id" title="var">Hk2</span> <span class="id" title="var">Hx</span> <span class="id" title="var">Hys'</span> <span class="id" title="var">Ha</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
   赤黒木となる条件その1: 全てのパスに関して黒ノードの数が等しくなること
 
<div class="paragraph"> </div>


<div class="paragraph"> </div>

   <span class="inlinecode"><span class="id" title="var">fromOrdListAux</span></span>の再帰呼び出しに関して次の普遍条件が成り立つことを示す補題
 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="fromOrdListAux_BalancedWithLength"><span class="id" title="lemma">fromOrdListAux_BalancedWithLength</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">k</span> <span class="id" title="var">xs</span> <span class="id" title="var">d</span> <span class="id" title="var">t</span> <span class="id" title="var">xs'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs'"><span class="id" title="variable">xs'</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#BalancedWithLength"><span class="id" title="inductive">BalancedWithLength</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#t"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab44"></a><h3 class="section">補助関数<span class="inlinecode"><span class="id" title="var">fromOrdListAux</span></span>を使って、求める関数を定義</h3>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Variable</span> <a name="R"><span class="id" title="variable">R</span></a> : <span class="id" title="keyword">Set</span>. <span class="id" title="keyword">Variable</span> <a name="floor"><span class="id" title="variable">floor</span></a> : <a class="idref" href="PFDS.3.RedBlackTree.html#R"><span class="id" title="axiom">R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="log2"><span class="id" title="variable">log2</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#R"><span class="id" title="axiom">R</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="fromOrdList"><span class="id" title="definition">fromOrdList</span></a> <span class="id" title="var">xs</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">n</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">maxDepth</span> := <a class="idref" href="PFDS.3.RedBlackTree.html#floor"><span class="id" title="axiom">floor</span></a> (<a class="idref" href="PFDS.3.RedBlackTree.html#log2"><span class="id" title="axiom">log2</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a>) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="PFDS.3.RedBlackTree.html#fromOrdListAux"><span class="id" title="definition">fromOrdListAux</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="PFDS.3.RedBlackTree.html#maxDepth"><span class="id" title="variable">maxDepth</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>